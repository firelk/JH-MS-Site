$(function(){for(var e={bankCard:function(e){return/^[\d]{14,19}$/.test(e)}},a="",n=0;n<window.PURPOSES.length;n++)a+='<option value="'+window.PURPOSES[n].code+'">'+window.PURPOSES[n].text+"</option>";$(".purpose").append(a),$("input[name='real_name']").change(function(){var e=$(this).val();$(this).val($.trim(e))});var r="";$(".sms-code").click(function(){var a=$(this);if($(".validator").validator(e)){var n=$("#activate-checkout-form").serializeJSON(),t={identity_card:{real_name:n.real_name,number:n.idCard},bankcard:{phone_number:n.phone_number,deposit_bank_province_code:n.deposit_bank_province_code,deposit_bank_city_code:n.deposit_bank_city_code,number:n.number}};$.postJSON("services/ayh/bankcardCaptcha",t,function(e){CommonUtil.parseHttpResponse(e,function(){r=e.result.bankcard_captcha_id,$.success("短信验证码已发送至手机，请注意查收",function(){a.countDown(),$('[name="bankcard_captcha"]').val("")})},function(e){$.error($.empty2def(e,"保存信息失败"))})})}}),$(".btn-activate").on("click",function(a){var n=$("#activate-checkout-form"),t=$(".form-yzm").val(),i=$("#agreement-radio").is(":checked");if(i||$.warn("请同意借款和征信协议"),n.validator(e)&&i){var o=n.serializeJSON(),c={auth_no:authNo,identity_card:{real_name:o.real_name,number:o.idCard},bankcard:{phone_number:o.phone_number,number:o.number,deposit_bank_province_code:o.deposit_bank_province_code,deposit_bank_city_code:o.deposit_bank_city_code},bankcard_captcha:{bankcard_captcha_id:r,bankcard_captcha:t},loanPurpose:o.loanPurpose};$.postJSON("services/ayh/whiteapply",c,function(e){CommonUtil.parseHttpResponse(e,function(){"0"==e.errorCode?CommonUtil.redirectUrl("loan/status?id="+e.result.application_id):$.warn(e.errorMsg)},function(e){$.error($.empty2def(e,"保存信息失败"))})})}}),$(".purpose").change(function(){var e=this.value,a=$(this).find('option[value="'+e+'"]').html();0==this.value?$(this).parent().find("input").val(""):$(this).parent().find("input").val(a)}),$(".yzm-fail a").click(function(){$.alert('<div class="yzm-fail-error" style="text-align: left;font-size: 0.7rem;line-height: 1rem;"><p>短信提交申请已发送到预留手机</p><p>如未收到:<br>1.请确认当前使用的号码为预留手机号码<br>2.请检查短信是否被安全软件拦截</p></div>')}),$("input[name='real_name']").change(function(){""!==$.trim($(this).val())?($(".greement-box").find(".loan-agreement").addClass("agreement-act"),""!=$.trim($("input[name='idCard']").val())?$(".greement-box").find(".loan-cragreement").addClass("agreement-act"):$(".greement-box").find(".loan-cragreement").removeClass("agreement-act")):($(".greement-box").find(".loan-agreement").removeClass("agreement-act"),$(".greement-box").find(".loan-cragreement").removeClass("agreement-act"))}).trigger("change"),$("input[name='idCard']").change(function(){var e=$.trim($(this).val());""!==$("input[name='real_name']").val()&&""!==e?$(".greement-box").find(".loan-cragreement").addClass("agreement-act"):$(".greement-box").find(".loan-cragreement").removeClass("agreement-act")}).trigger("change"),$(".loan-agreement").click(function(){var e=$.trim($("input[name='real_name']").val());console.log(e),$(this).hasClass("agreement-act")?$.ajax({type:"post",url:"services/ayh/aloan",data:{name:e},success:function(e){"0"!=e.errorCode?$.warn(e.errorMsg):$.alert(e.result)}}):""==name&&$.warn("姓名不能为空")}),$(".loan-cragreement").click(function(){var e=$.trim($("input[name='real_name']").val()),a=$.trim($("input[name='idCard']").val()),n={idNo:a,name:e};$(this).hasClass("agreement-act")?$.ajax({type:"post",url:"services/ayh/zxaloan",data:n,success:function(e){"0"!=e.errorCode?$.warn(e.errorMsg):$.alert(e.result)}}):(""==e&&""==a&&$.warn("姓名身份证不能为空"),""==e&&""!==a&&$.warn("姓名不能为空"),""==a&&""!==e&&$.warn("身份证不能为空"))})});