$(function(){var a=$("#form_paypsw");a.validate({rules:{payPassword_rsainput:{minlength:6,maxlength:6,required:!0,digits:!0}},messages:{payPassword_rsainput:{required:'<i class="icon icon-attention icon-lg"></i>&nbsp;请填写支付密码',maxlength:'<i class="icon icon-attention icon-lg"></i>&nbsp;密码最多为{0}个字符',minlength:'<i class="icon icon-attention icon-lg"></i>&nbsp;密码最少为{0}个字符',digits:'<i class="icon icon-attention icon-lg"></i>&nbsp;密码只能为数字'}},errorPlacement:function(a,s){s.closest('div[data-error="i_error"]').append(a)},submitHandler:function(a){$(a)}});var s=$("#payPassword_container"),i=s.find("i"),e=0,n=0,t=$("#cardwrap");s.on("focus","input[name='payPassword_rsainput']",function(){var a=s.find("i");"0"===s.attr("data-busy")&&(a.eq(e).addClass("active"),t.css("visibility","visible"),s.attr("data-busy","1"))}),s.on("change","input[name='payPassword_rsainput']",function(){t.css("visibility","hidden"),i.eq(e).removeClass("active"),s.attr("data-busy","0")}).on("blur","input[name='payPassword_rsainput']",function(){t.css("visibility","hidden"),i.eq(e).removeClass("active"),s.attr("data-busy","0")}),s.on("keyup","input[name='payPassword_rsainput']",function(a){if(8==(a=a||window.event).keyCode||a.keyCode>=48&&a.keyCode<=57||a.keyCode>=96&&a.keyCode<=105)for(e=this.value.length,l=i.length;l--;)l===e?(i.eq(l).addClass("active"),i.eq(l).find("b").css("visibility","hidden")):(i.eq(l).removeClass("active"),i.eq(l).find("b").css("visibility",l<e?"visible":"hidden")),n=6===e?5:e,$("#cardwrap").css("left",39*n+"px");else{var s=this.value;this.value=s.replace(/\D/g,"")}}),a.submit(function(a){return console.log(112311),!1}),$(".pass-next").click(function(a){if(0==$("#payPassword_rsainput-error").length&&6==$("#payPassword_rsainput").val().length){$(".step1").addClass("hide"),$(".pass-next").addClass("hide"),$(".step2").removeClass("hide"),$(".pass-submit").removeClass("hide");var s=$("#payPassword_rsainput");$("#payPassword_rsainput").data("pwd1",s.val()),s.val(""),$(".sixDigitPassword-box").find("i b").css({visibility:"hidden"}),s.focus(),$("#cardwrap").css("left",0)}return!1}),$(".pass-reset").click(function(a){return CommonUtil.redirectUrl("pay/pay_password.html?v_"+(new Date).getTime()),!1}),$(".pass-submit").click(function(a){var s=$("#payPassword_rsainput").val();return 6==s.length?$.ajax({url:window._appPath+"transpassword/valid.do",type:"post",dataType:"json",data:{openId:$.cookie("openId"),transPassword:s}}).done(function(a){var s=a;console.log(s,"支付密码"),0==a.code?($(".box-6-1").removeClass("hide"),$(".box-6").addClass("hide"),$(".btn").addClass("hide"),$("#code").qrcode({render:"table",width:200,height:200,text:a.data.paycode}),JsBarcode("#barcode1",a.data.paycode,{displayValue:!1})):$.alert(a.message)}).fail(function(){console.log("error")}).always(function(){console.log("complete")}):$("#payPassword_container").append('<span id="payPassword_rsainput-error" class="help-block"><i class="icon icon-attention icon-lg"></i>&nbsp;密码不够6位</span>'),!1})});